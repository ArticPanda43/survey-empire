<p id="notice"><%= notice %></p>
<% if params['drafts'] == 'true' then %>
Showing Surveys that the Current User has made
<% else %>
Showing all surveys
<% end %>
<h1>Surveys</h1>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Creationdate</th>
      <th>Expirydate</th>
      <th>Likes</th>
      <th>Dislikes</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @surveys.each do |survey| %>
      <tr>
        <td><%= survey.survey_name %></td>
        <td><%= survey.creationDate %></td>
        <td><%= survey.expiryDate %></td>
        <td><%= survey.likes %></td>
        <td><%= survey.dislikes %></td>

        <% if QuestionAnswer.where(:user_id => current_user).where(:survey_id => survey).select("COUNT(*)").size > 0 %>
          <%# they have answered the question %>
          <td><%= link_to 'Show', survey_path(survey) + '?answered=true' %></td>
        <% else %>
          <%# they have not answered the question %>
          <td><%= link_to 'Answer Survey', survey_path(survey) + '?answered=false' %></td>
        <% end %>
        <td><%= link_to 'Edit', edit_survey_path(survey) %></td>
        <td><%= link_to 'Destroy', survey, method: :delete, data: { confirm: 'Are you sure?' } %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<br>

<%= link_to 'New Survey', new_survey_path %>
